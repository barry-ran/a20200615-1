(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesReserve/orderDetail/orderDetail"],{"0a5e":function(a,t,e){"use strict";e.r(t);var n=e("abfe"),i=e("ade9");for(var o in i)"default"!==o&&function(a){e.d(t,a,function(){return i[a]})}(o);e("10b4");var d,s=e("f0c5"),r=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],d);t["default"]=r.exports},"10b4":function(a,t,e){"use strict";var n=e("7f41"),i=e.n(n);i.a},"5bd6":function(a,t,e){"use strict";(function(a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=e("88e4"),i={data:function(){return{$imgurl:this.$imgurl,id:"",bg:"",picList:[],datas:{yhInfo:{mj:[]},beizhu_val:[],store_info:[]},comment:"",jhsl:1,dprice:"",yhje:0,hjjg:"",sfje:"",order:"",pro_name:"",pro_tel:"",pro_address:"",pro_txt:"",my_num:"",my_gml:"",xg_num:"",shengyu:"",cdd:"",chuydate:"",chuytime:"",num:{index:{index:""}},xz_num:[],couponprice:0,jqdjg:"请选择",yhqid:"0",oldsfje:"",pagedata:{},hxmm:"",hxmm_list:[{val:"",fs:!0},{val:"",fs:!1},{val:"",fs:!1},{val:"",fs:!1},{val:"",fs:!1},{val:"",fs:!1}],showhx:0,orderFormDisable:!0,isChange:"",formchangeBtn:1,dkscore:0,dkmoney:0,yhqmoney_s:0,zf_type:"",tableis:0,orderid:"",manjian_info:"",moneyoffstr:"",jifen_u:0,yue:0,mymoney:0,modify_date_begin:"",animationData:"",myscore:0,pay_price:0,pay_type:1,show_pay_type:0,alipay:1,wxpay:1,hx_choose:0,baseinfo:"",hx_ewm:""}},onPullDownRefresh:function(){var t=this,e=t.order;t.getOrder(e),a.stopPullDownRefresh()},onLoad:function(a){var t=this,e=a.id;t.order=e,a.tableis&&(t.tableis=a.tableis),0==a.tsid?t.tableis=0:t.tableis=1;var i=0;a.fxsid&&(i=a.fxsid),this.fxsid=i,this._baseMin(this),n.bdLogin(i,function(){var a=t.order;t.getOrder(a)})},methods:{makePhoneCall:function(t){var e=t.currentTarget.dataset.tel;a.makePhoneCall({phoneNumber:e})},changeOrderFormDisable:function(){this.orderFormDisable=!1,this.isChange="isChange",this.formchangeBtn=3},changeOrderFormConfirm:function(){var t=this;a.showModal({title:"确定提交吗",content:"只有一次修改的机会哦",success:function(e){e.confirm&&a.request({url:t.$baseurl+"doPageapplyModifyAppointInfo",data:{pro_name:t.pro_name,pro_tel:t.pro_tel,pro_address:t.pro_address,chuydate:t.chuydate,chuytime:t.chuytime,order_id:t.order,uniacid:t.$uniacid},success:function(e){t.orderFormDisable=!0,t.isChange="",t.formchangeBtn=4,a.showModal({title:"提示",content:"信息修改成功，请等待后台管理员审核！",showCancel:!1})}})}})},changeOrderFormCancel:function(){this.orderFormDisable=!0,this.isChange="",this.formchangeBtn=2},ContactMerchant:function(){var t=this;a.showModal({title:"提示",content:"请联系商家咨询具体信息！",confirmText:"联系商家",success:function(e){if(e.confirm){var n=t.baseinfo.tel;a.makePhoneCall({phoneNumber:n})}}})},getOrder:function(t){var e=this;a.request({url:e.$baseurl+"doPagemycoupon",data:{suid:a.getStorageSync("suid"),uniacid:e.$uniacid},success:function(a){e.couponlist=a.data.data},fail:function(a){}}),a.request({url:e.$baseurl+"doPageOrderinfo",data:{order:t,suid:a.getStorageSync("suid"),uniacid:e.$uniacid},cachetime:"30",success:function(t){e.yhje;var n=t.data.data.yhInfo,i=t.data.data.order_id;0!=n&&(n["score"]["money"]>0?(e.ischecked=!0,e.jifen_u=1,e.dkscore=n["score"]["msg"].slice(0,n["score"]["msg"].indexOf("积分")),e.dkmoney=n["score"]["money"]):e.jifen_u=0,console.log(n),console.log(n["mj"]),n["mj"]?e.manjian_info=n["mj"]["msg"]:e.manjian_info="无",n["yhq"]?e.jqdjg=n["yhq"]["msg"]:e.jqdjg="无");for(var o=t.data.data.more_type_x,d=[],s={},r=0,c=0;c<o.length;c++)s[c]=o[c][4],d.push(s),r=(100*r+100*o[c][4])/100;if("3"==t.data.data.flag&&"1"==t.data.data.pro_flag_ding?e.formchangeBtn=0:"1"!=t.data.data.flag||0!=t.data.data.can_modify||t.data.data.modify_info?"1"!=t.data.data.flag||1!=t.data.data.can_modify||t.data.data.modify_info?t.data.data.modify_info&&1==t.data.data.modify_flag?e.formchangeBtn=4:t.data.data.modify_info&&2==t.data.data.modify_flag?e.formchangeBtn=5:t.data.data.modify_info&&3==t.data.data.modify_flag&&(e.formchangeBtn=6):e.formchangeBtn=2:e.formchangeBtn=1,e.id=t.data.data.pid,e.datas=t.data.data,e.dprice=t.data.data.price,e.jhsl=t.data.data.num,e.hjjg=t.data.data.price,e.sfje=t.data.data.true_price,e.pro_name=t.data.data.pro_user_name,e.pro_tel=t.data.data.pro_user_tel,e.pro_address=t.data.data.pro_user_add,e.pro_txt=t.data.data.pro_user_txt,e.my_num=t.data.data.my_num,e.xg_num=t.data.data.pro_xz,e.shengyu=t.data.data.pro_kc,e.my_gml=t.data.data.my_num,e.cdd=t.data.data.mcount,e.chuydate=t.data.data.chuydate,e.chuytime=t.data.data.chuytime,e.modify_date_begin=t.data.data.modify_date_begin,e.num=d,e.chooseNum=r,e.xz_num=t.data.data.more_type_num,e.oldsfje=t.data.data.price,e.yhqid=t.data.data.couponid,e.pagedata=t.data.data.beizhu_val,e.myscore=parseFloat(t.data.data.my_score),e.mymoney=parseFloat(t.data.data.my_money),e.zf_type=parseFloat(t.data.data.my_money)>=t.data.data.true_price?0:1,e.orderid=i,e.pay_price=t.data.data.pay_price,1==e.zf_type){var u=(e.sfje-e.pay_price).toFixed(2);e.yue=u}a.setNavigationBarTitle({title:e.datas.product}),a.setStorageSync("isShowLoading",!1),0==t.data.data.flag&&a.request({url:e.$baseurl+"doPagegetmoneyoff",data:{uniacid:e.$uniacid},success:function(a){for(var t=a.data.data,n="",i=0;i<t.length;i++)i==t.length-1?n+="满"+t[i].reach+"减"+t[i].del:n+="满"+t[i].reach+"减"+t[i].del+"，";e.sfje;e.moneyoff=t,e.moneoffstr=t?n:""}})}})},getmyinfo:function(){var t=this,e=(a.getStorageSync("suid"),t.moneyoff),n=t.hjjg,i=n;if(e)for(var o=e.length-1;o>=0;o--)if(i>=parseFloat(e[o].reach)){i-=parseFloat(e[o].del);break}t.sfje=i,t.zf_type=t.mymoney>=i?0:1},jian:function(a){var t=this,e=t.yhje,n=a.currentTarget.dataset.testid,i=a.currentTarget.dataset.testkey,o=t.num[i][i],d=(t.duogg,t.sfje),s=t.hjjg,r=t.oldsfje;if(o--,o<0)o=0;else{var c=Math.round(100*r-100*n*o+100*n*(o-1))/100;d=c-e,s=c,r=c;var u=t.num;u[i][i]=o,t.num=u,t.sfje=d,t.hjjg=s,t.jqdjg="请选择",t.oldsfje=r,t.yhqid=0}t.getmyinfo()},jia:function(t){var e=this,n=(e.yhje,t.currentTarget.dataset.testid),i=t.currentTarget.dataset.testkey,o=e.num[i][i],d=(e.duogg,e.oldsfje),s=e.hjjg,r=e.xz_num,c=r[i].shennum;if(o++,o>c)return o--,a.showModal({title:"提醒",content:"库存量不足！",showCancel:!1}),!1;var u=Math.round(100*n*o+100*d-100*n*(o-1))/100;d=u,s=u;var l=e.num;l[i][i]=o;var h=e.chooseNum+1;e.num=l,e.hjjg=s,e.jqdjg="请选择",e.oldsfje=d,e.yhqid=0,e.chooseNum=h,e.ischecked=!1,e.dkscore=0,e.dkmoney=0,e.jifen_u=2,e.getmyinfo()},userNameInput:function(a){this.pro_name=a.detail.value},userTelInput:function(a){this.pro_tel=a.detail.value},userAddInput:function(a){this.pro_address=a.detail.value},userTextInput:function(a){this.pro_txt=a.detail.value},save:function(){var t=this,e=t.jhsl,n=t.shengyu,i=t.tableis;if(1!=i&&e>n&&-1!=n)return e--,a.showModal({title:"提醒",content:"库存量不足！",showCancel:!1}),!1;for(var o=t.sfje,d=a.getStorageSync("suid"),s=(t.duogg,t.num),r=(s[0],[]),c={},u=0;u<s.length;u++){var l=parseInt(s[u][u]);c[u]=l,r.push(c)}var h=t.chuydate,f=t.chuytime,m=(t.yhje,t.id),p=t.order,y=t.pro_name,g=t.pro_tel,_=t.pro_address,v=t.pro_txt,j=(t.id,t.yhqid),x=!0;if(0==o)return x=!1,a.showModal({title:"提醒",content:"请至少选择一个规格的商品！",showCancel:!1}),!1;if(!y&&2==t.datas.pro_flag)return x=!1,a.showModal({title:"提醒",content:"姓名为必填！",showCancel:!1}),!1;var w=/^(((13[0-9]{1})|(14[0-9]{1})|(15[0-9]{1})|(16[0-9]{1})|(17[0-9]{1})|(18[0-9]{1})|(19[0-9]{1}))+\d{8})$/;if(!g&&2==t.datas.pro_flag_tel)return x=!1,a.showModal({title:"提醒",content:"手机号为必填！",showCancel:!1}),!1;if(!w.test(g)&&2==t.datas.pro_flag_tel)return a.showModal({title:"提醒",content:"请输入有效的手机号码！",showCancel:!1}),!1;if(!_&&2==t.datas.pro_flag_add)return x=!1,a.showModal({title:"提醒",content:"地址为必填！",showCancel:!1}),!1;if("选择日期"==h&&2==t.datas.pro_flag_data)return x=!1,a.showModal({title:"提醒",content:"请选择日期！",showCancel:!1}),!1;if("选择时间"==f&&2==t.datas.pro_flag_time)return x=!1,a.showModal({title:"提醒",content:"请选择时间！",showCancel:!1}),!1;var b=t.pagedata;for(u=0;u<b.length;u++)if(1==b[u].ismust&&""==b[u].val)return x=!1,a.showModal({title:"提醒",content:b[u].name+"为必填项！",showCancel:!1}),!1;if(x){var C=t.orderid;C?o<=t.mymoney?t.pay1(C):t._baidupay(t,t.pay_price,"reserve",C,"/pagesReserve/orderList/orderList"):a.request({url:t.$baseurl+"doPagecreateorder",data:{suid:d,num:JSON.stringify(r),id:m,hjjg:t.hjjg,zhifu:o,order:p,pro_name:y,pro_tel:g,pro_address:_,pro_txt:v,chuydate:h,chuytime:f,yhqid:j,dkscore:t.dkscore,dkmoney:t.dkmoney,pagedata:JSON.stringify(b),types:"reserve",uniacid:t.$uniacid},header:{"content-type":"application/json"},success:function(e){if("1"==e.data.data.errcode)a.showModal({title:e.data.data.err,content:"请重新下单",showCancel:!1});else if("3"==e.data.data.errcode)a.showModal({title:e.data.data.err,content:"当前库存为"+e.data.data.kc+"件",showCancel:!1});else{var n=e.data.data;t.orderid=n,o<=t.mymoney?t.pay1(n):t.pay2(n)}}})}},showpay:function(){var t=this;a.request({url:this.$baseurl+"doPageGetH5payshow",data:{uniacid:this.$uniacid,suid:a.getStorageSync("suid")},success:function(e){0==e.data.data.ali&&0==e.data.data.wx?a.showModal({title:"提示",content:"请联系管理员设置支付参数",success:function(t){a.redirectTo({url:"/pages/index/index"})}}):(0==e.data.data.ali?(t.alipay=0,t.pay_type=2):(t.alipay=1,t.pay_type=1),0==e.data.data.wx?t.wxpay=0:t.wxpay=1,t.show_pay_type=1)}})},changealipay:function(){this.pay_type=1},changewxpay:function(){this.pay_type=2},close_pay_type:function(){this.show_pay_type=0},h5topay:function(){var a=this.pay_type;1==a?this._alih5pay(this,this.pay_price,9,this.orderid):2==a&&this._wxh5pay(this,this.pay_price,"reserve",this.orderid),this.show_pay_type=0},pay1:function(t){var e=this;a.showModal({title:"请注意",content:"您将使用余额支付"+e.sfje+"元",success:function(n){n.confirm&&(e.payover_do(t),a.showLoading({title:"下单中...",mask:!0}))}})},pay2:function(t){var e=this,n=a.getStorageSync("suid"),i=e.sfje;a.request({url:e.$baseurl+"doPagebeforepay",data:{suid:n,price:i,order_id:t,types:"reserve",formId:e.formId,uniacid:e.$uniacid},header:{"content-type":"application/json"},success:function(n){1==n.data.data.errs&&a.showModal({title:"支付失败",content:n.data.data.return_msg,showCancel:!1});var i=[1,2,3,4];-1!=i.indexOf(n.data.data.err)&&a.showModal({title:"支付失败",content:n.data.data.message,showCancel:!1}),0==n.data.data.err&&(a.request({url:e.$baseurl+"doPagesavePrepayid",data:{types:"reserve",order_id:t,prepayid:n.data.data.package,uniacid:e.$uniacid},success:function(a){},fail:function(a){}}),a.requestPayment({timeStamp:n.data.data.timeStamp,nonceStr:n.data.data.nonceStr,package:n.data.data.package,signType:"MD5",paySign:n.data.data.paySign,success:function(n){a.showToast({title:"支付成功",icon:"success",duration:3e3,success:function(n){e.payover_fxs(t),a.showToast({title:"购买成功！",icon:"success",success:function(){setTimeout(function(){a.navigateBack({delta:9}),a.navigateTo({url:"/pagesReserve/orderList/orderList"})},1500)}})}})},fail:function(a){},complete:function(a){}}))}})},payover_do:function(t){var e=this,n=a.getStorageSync("suid"),i=e.sfje;a.request({url:e.$baseurl+"doPagepaynotify",data:{out_trade_no:t,suid:n,payprice:i,types:"reserve",flag:0,formId:e.formId,uniacid:e.$uniacid},success:function(t){a.showToast({title:"购买成功！",icon:"success",success:function(){setTimeout(function(){a.navigateBack({delta:9}),a.navigateTo({url:"/pagesReserve/orderList/orderList"})},1500)}})}})},passd:function(){var t=this,e=t.order;a.showModal({title:"提醒",content:"亲，您确定要删除该订单？",success:function(n){n.confirm&&a.request({url:t.$baseurl+"doPagedpass",data:{order:e,uniacid:t.$uniacid},header:{"content-type":"application/json"},success:function(t){1==t.data.data&&a.showToast({title:"订单取消成功",icon:"success",duration:2e3,success:function(){a.redirectTo({url:"/pagesReserve/orderList/orderList?type=9"})}})}})}})},bindDateChange2:function(a){this.chuydate=a.detail.value},bindTimeChange2:function(a){this.chuytime=a.detail.value},getmoney:function(t){var e=this,n=t.currentTarget.id,i=t.currentTarget.dataset.index,o=i["coupon"]["pay_money"],d=e.hjjg,s=e.sfje;if(1*d<1*o)a.showModal({title:"提示",content:"价格未满"+o+"元，不可使用该优惠券！",showCancel:!1});else{var r=(100*s-100*n)/100,c={detail:{value:!1}};e.ischecked=!1,e.switchChange(c),s=parseFloat(r.toPrecision(12))+parseFloat(e.dkmoney),s<0&&(s=0),e.jqdjg=n,e.yhqid=i["id"],e.sfje=s,e.oldsfje=d,e.yhqmoney_s=n,e.zf_type=e.mymoney>=s?0:1,e.hideModal()}},qxyh:function(){var a=this,t=a.jqdjg;"请选择"==t&&(t=0);a.sfje;a.hideModal(),a.jqdjg=0,a.yhqid=0,a.sfje=huany,a.jqdjg="请选择"},showModal:function(){var t=a.createAnimation({duration:200,timingFunction:"linear",delay:0});this.animation=t,t.translateY(300).step(),this.animationData=t.export(),this.showModalStatus=!0,setTimeout(function(){t.translateY(0).step(),this.animationData=t.export()}.bind(this),200)},hideModal:function(){var t=a.createAnimation({duration:200,timingFunction:"linear",delay:0});this.animation=t,t.translateY(300).step(),this.animationData=t.export(),setTimeout(function(){t.translateY(0).step(),animationData=t.export(),showModalStatus=!1}.bind(this),200)},switchChange:function(t){var e=this,n=t.detail.checked,i=a.getStorageSync("suid"),o=e.sfje,d=0,s=e.type,r="table"==s?e.select_num:e.chooseNum;1==n?a.request({url:e.$baseurl+"doPagescoreDeduction",data:{id:e.id,num:r,suid:i,is_more:1,uniacid:e.$uniacid},header:{"content-type":"application/json"},success:function(a){var t=a.data.data;d=t["moneycl"];var n=t["gzmoney"],i=t["gzscore"];if(o<d&&(d=parseInt(o)),0==d)var s=0;else s=d*i/n;o=Math.round(100*(o-d))/100,e.sfje=o,e.dkmoney=d,e.dkscore=s,e.jifen_u=1,e.zf_type=e.mymoney>=o?0:1}}):(o=parseFloat(o)+parseFloat(e.dkmoney),e.dkmoney=0,e.dkscore=0,e.jifen_u=0,e.zf_type=e.mymoney>=o?0:1)},bindInputChange:function(a){var t=this,e=a.detail.value,n=a.currentTarget.dataset.index,i=t.pagedata;i[n].val=e,t.pagedata=i},bindPickerChange:function(a){var t=this,e=a.detail.value,n=a.currentTarget.dataset.index,i=t.pagedata,o=i[n].tp_text,d=o[e];i[n].val=d,t.pagedata=i},bindDateChange:function(a){var t=this,e=a.detail.value,n=a.currentTarget.dataset.index,i=t.pagedata;i[n].val=e,t.pagedata=i},bindTimeChange:function(a){var t=this,e=a.detail.value,n=a.currentTarget.dataset.index,i=t.pagedata;i[n].val=e,t.pagedata=i},checkboxChange:function(a){var t=this,e=a.detail.value,n=a.currentTarget.dataset.index,i=t.pagedata;i[n].val=e,t.pagedata=i},radioChange:function(a){var t=this,e=a.detail.value,n=a.currentTarget.dataset.index,i=t.pagedata;i[n].val=e,t.pagedata=i},hxmmInput:function(a){for(var t=a.target.value.length,e=0;e<this.hxmm_list.length;e++)this.hxmm_list[e].fs=!1,this.hxmm_list[e].val=a.target.value[e];t&&(this.hxmm_list[t-1].fs=!0),this.hxmm=a.target.value},hxmmpass:function(){var t=this,e=t.hxmm,n=t.datas;e?a.request({url:t.$baseurl+"hxmm",data:{hxmm:e,order_id:n.order_id,uniacid:t.$uniacid,suid:a.getStorageSync("suid"),is_more:1},header:{"content-type":"application/json"},success:function(e){var i=e.data.data;if(0==i){a.showModal({title:"提示",content:"核销密码不正确！",showCancel:!1}),t.hxmm="";for(var o=0;o<t.hxmm_list.length;o++)t.hxmm_list[o].fs=!1,t.hxmm_list[o].val=""}else a.showToast({title:"消费成功",icon:"success",duration:2e3,success:function(a){n["flag"]=2,t.datas=n,t.showhx=0,t.hxmm="";var e=t.order;t.getOrder(e)}})}}):a.showModal({title:"提示",content:"请输入核销密码！",showCancel:!1})},hxshow:function(){var a=this;a.showhx=1},hxhide:function(){var a=this;a.showhx=0,a.hxmm=""},gethxmima:function(){this.hx_choose=1},gethxImg:function(){var t=this;a.request({url:this.$baseurl+"doPageHxEwm",data:{uniacid:this.$uniacid,suid:a.getStorageSync("suid"),pageUrl:"proDetail",orderid:this.order},success:function(a){t.hx_ewm=a.data.data,t.hx_choose=2}})},hxhide1:function(){this.hx_choose=0,this.hxmm="";for(var a=0;a<this.hxmm_list.length;a++)this.hxmm_list[a].fs=!1,this.hxmm_list[a].val=""}}};t.default=i}).call(this,e("5486")["default"])},"6a7a":function(a,t,e){"use strict";(function(a){e("d28f");n(e("66fd"));var t=n(e("0a5e"));function n(a){return a&&a.__esModule?a:{default:a}}a(t.default)}).call(this,e("5486")["createPage"])},"7f41":function(a,t,e){},abfe:function(a,t,e){"use strict";var n,i=function(){var a=this,t=a.$createElement;a._self._c},o=[];e.d(t,"b",function(){return i}),e.d(t,"c",function(){return o}),e.d(t,"a",function(){return n})},ade9:function(a,t,e){"use strict";e.r(t);var n=e("5bd6"),i=e.n(n);for(var o in n)"default"!==o&&function(a){e.d(t,a,function(){return n[a]})}(o);t["default"]=i.a}},[["6a7a","common/runtime","common/vendor"]]]);