(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesPluginForum/forum_page/forum_page"],{"31ea":function(t,e,n){"use strict";(function(t){n("d28f");a(n("66fd"));var e=a(n("7efd"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("5486")["createPage"])},"72dd":function(t,e,n){"use strict";var a=n("92fb"),i=n.n(a);i.a},"786c":function(t,e,n){"use strict";var a={auth:()=>Promise.all([n.e("common/vendor"),n.e("components/auth/auth")]).then(n.bind(null,"a32a")),bindPhone:()=>Promise.all([n.e("common/vendor"),n.e("components/bindPhone/bindPhone")]).then(n.bind(null,"9bb9"))},i=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"b",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"a",function(){return a})},"7efd":function(t,e,n){"use strict";n.r(e);var a=n("786c"),i=n("d51c");for(var o in i)"default"!==o&&function(t){n.d(e,t,function(){return i[t]})}(o);n("72dd");var u,s=n("f0c5"),r=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],u);e["default"]=r.exports},"92fb":function(t,e,n){},d51c:function(t,e,n){"use strict";n.r(e);var a=n("e39c"),i=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,function(){return a[t]})}(o);e["default"]=i.a},e39c:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n("88e4"),i=(getApp(),{data:function(){return{$imgurl:this.$imgurl,page_signs:"/pagesPluginForum/index/index",baseinfo:"",needAuth:!1,needBind:!1,article_con:"",suid:"",nickname:"",rid:"",page:1,count:0,moreComment:!1,commentList:[],commentCon:"",repto_suid:"",commentId:"",alert_del:0,types:"",delid:"",settop:""}},onPullDownRefresh:function(){this.getcontent(),t.stopPullDownRefresh()},onLoad:function(e){var n=this;this._baseMin(this);var i=e.rid;this.rid=i;var o=0;this.suid=t.getStorageSync("suid");var u=t.getStorageSync("suid");u?a.bdLogin(o,function(){n.getcontent()}):this.getcontent()},onShow:function(){this.getcontent()},methods:{cell:function(){this.needAuth=!1},closeAuth:function(){this.needAuth=!1,this.needBind=!0},closeBind:function(){this.needBind=!1},getSuid:function(){var e=t.getStorageSync("suid");if(e)return!0;var n="";return n=t.getStorageSync("baidu_userinfo"),n?this.needBind=!0:this.needAuth=!0,!1},getcontent:function(){var e=this;t.request({url:e.$baseurl+"doPageGetForumCon",data:{uniacid:e.$uniacid,rid:e.rid,suid:t.getStorageSync("suid")},success:function(n){1==e.baseinfo.can_fs&&t.setNavigationBarTitle({title:n.data.data.content.substring(0,10)}),e.article_con=n.data.data,e.fid=n.data.data.fid,e.settop=n.data.data.settop,e.getcomment()},fail:function(t){}})},getcomment:function(){var e=this,n=e.page,a=e.rid;t.request({url:e.$baseurl+"doPageGetForumComment",data:{rid:a,page:n,uniacid:e.$uniacid,suid:t.getStorageSync("suid")},success:function(t){if(""!=t.data.data.list){var n=t.data.data.count;n.length>10?e.moreComment=!0:e.moreComment=!1,e.count=t.data.data.count,e.commentList=t.data.data.list}else e.count=t.data.data.count,e.moreComment=!1}})},toReply:function(t){var e=this;console.log(t),e.nickname=t.currentTarget.dataset.nickname,e.repto_suid=t.currentTarget.dataset.uid,e.commentId=t.currentTarget.dataset.commentid},getInputCon:function(e){var n=this,a=e.detail.value;a.length>100?t.showModal({title:"提醒",content:"字数不能大于100",showCancel:!1}):n.commentCon=a},commentSub:function(e){if(!this.getSuid())return!1;var n=this,a=n.commentCon;if(""==a)return t.showModal({title:"提示",content:"评论不能为空",showCancel:!1}),!1;if(a.length>100)return t.showModal({title:"提示",content:"评论内容超出允许范围!",showCancel:!1}),!1;var i=n.rid;t.request({url:n.$baseurl+"doPageForumCommentSub",data:{uniacid:n.$uniacid,rid:i,suid:n.suid,content:a,repto_suid:n.repto_suid,commentId:n.commentId,source:t.getStorageSync("source")},success:function(e){1==e.data.data?t.showModal({title:"提示",content:"发布成功",showCancel:!1,success:function(e){t.redirectTo({url:"/pagesPluginForum/forum_page/forum_page?rid="+i})}}):t.showModal({title:"提示",content:"发布失败，请重新发布",showCancel:!1})}})},setChange:function(){var e=this;t.navigateTo({url:"/pagesPluginForum/release/release?rid="+e.rid+"&fid="+e.fid})},pagedel:function(e){var n=this,a=n.fid,i=e.currentTarget.dataset.types;t.showModal({title:"提示",content:"谨慎操作，删除后数据无法恢复!",cancelText:"取消删除",confirmText:"确认删除",success:function(o){if(!o.confirm)return!1;t.request({url:n.$baseurl+"doPageForumPageDel",data:{uniacid:n.$uniacid,id:e.currentTarget.dataset.id,types:i},success:function(e){1==e.data.data?t.showToast({title:"删除成功",success:function(){setTimeout(function(){1==i?t.redirectTo({url:"/pagesPluginForum/forum/forum?fid="+a}):2!=i&&3!=i||t.redirectTo({url:"/pagesPluginForum/forum_page/forum_page?rid="+n.rid})},2e3)}}):t.showToast({title:"删除失败"})},fail:function(t){}})}})},alertdel:function(t){this.alert_del=1,this.types=t.currentTarget.dataset.types,this.delid=t.currentTarget.dataset.id},hide_alert_del:function(){this.alert_del=0},commentAddLikes:function(e){if(!this.getSuid())return!1;var n=this,a=e.currentTarget.dataset.type,i=e.currentTarget.dataset.commentid,o=e.currentTarget.dataset.index;if(2==a)var u=e.currentTarget.dataset.topindex;t.request({url:n.$baseurl+"doPageCommentChangeLikes",data:{uniacid:n.$uniacid,commentType:a,commentid:i,suid:t.getStorageSync("suid"),vs:1},success:function(e){var a=e.data.data.is_like;1==a?t.showToast({title:"点赞成功",success:function(){var t=n.commentList;t[o]["likesNum"]=e.data.data.num,t[o]["is_like"]=1,n.commentList=t}}):2==a?t.showToast({title:"取赞成功",success:function(){var t=n.commentList;console.log(t),t[o]["likesNum"]=e.data.data.num,t[o]["is_like"]=2,n.commentList=t}}):3==a?t.showToast({title:"点赞成功",success:function(){var t=n.commentList;console.log(t),t[u]["reply"][o]["likesNum"]=e.data.data.num,t[u]["reply"][o]["is_like"]=1,n.commentList=t}}):4==a&&t.showToast({title:"取赞成功",success:function(){var t=n.commentList;t[u]["reply"][o]["likesNum"]=e.data.data.num,t[u]["reply"][o]["is_like"]=2,n.commentList=t}})},fail:function(t){}})},changeLikes:function(){if(!this.getSuid())return!1;var e=this;t.request({url:e.$baseurl+"doPageForumLikes",data:{uniacid:e.$uniacid,suid:t.getStorageSync("suid"),rid:e.rid,vs:1},success:function(n){var a=e.article_con;1==n.data.data.is_like?(t.showToast({title:"点赞成功"}),a.is_like=1):2==n.data.data.is_like&&(t.showToast({title:"取赞成功"}),a.is_like=2),a.likes=n.data.data.num,e.article_con=a}})},changeCollection:function(){if(!this.getSuid())return!1;var e=this;t.request({url:e.$baseurl+"doPageForumCollection",data:{uniacid:e.$uniacid,suid:t.getStorageSync("suid"),rid:e.rid,vs:1},success:function(n){var a=e.article_con;1==n.data.data.is_collect?(t.showToast({title:"收藏成功"}),a.is_collect=1):2==n.data.data.is_collect&&(t.showToast({title:"取收成功"}),a.is_collect=2),a.collection=n.data.data.num,e.article_con=a}})},makephone:function(e){var n=e.currentTarget.dataset.tel;t.makePhoneCall({phoneNumber:n})},setStick:function(){var e=this;t.navigateTo({url:"/pagesPluginForum/set_top/set_top?fid="+e.fid+"&rid="+e.rid+"&returnpage=1"})}}});e.default=i}).call(this,n("5486")["default"])}},[["31ea","common/runtime","common/vendor"]]]);