(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesGiftCard/card_getPro/card_getPro"],{"0d9b":function(t,a,e){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;e("2f62");var i=function(){return e.e("components/datetime/datetime").then(e.bind(null,"c598"))},n=e("88e4"),d={data:function(){return{$imgurl:this.$imgurl,$host:this.$host,baseinfo:"",suid:"",openid:"",currentTab:1,start_year:2019,end_year:2060,order_id:"",info:[],default_address:"",add_id:0,default_concat:"",self_taking_time:"",shop_info:"",shop_id:0,take_self:0,ps_name:"",zq_name:"",error_num:1,nav:0,is_sub:0}},components:{datetime:i},onLoad:function(a){var e=this,i="";i=t.getStorageSync("openid"),this.openid=i;var d=a.add_id;d&&(this.add_id=d);var s=a.shop_id;s&&(this.shop_id=s);var r=t.getStorageSync("suid");r&&(this.suid=r);var o=a.nav;o&&(this.nav=o,this.currentTab=2==o?2:1);var c="";a.order_id&&(c=a.order_id),this.order_id=c,this._baseMin(this);var u=0;a.fxsid&&(u=a.fxsid),this.fxsid=u,this.myContactInfo(),n.bdLogin(u,function(){e.getpro()})},onPullDownRefresh:function(){this.getpro(),t.stopPullDownRefresh()},methods:{clickTab:function(t){var a=this;a.currentTab=t.currentTarget.dataset.current},add_address:function(){t.navigateTo({url:"/pages/address/address?add_id="+this.add_id+"&shop_id="+this.shop_id+"&nav="+this.nav+"&order_id="+this.order_id+"&pro_type=giftcard"})},chooseStore:function(){t.navigateTo({url:"/pages/chooseStore/chooseStore?nav="+this.nav+"&address_id="+this.add_id+"&stid="+this.shop_id+"&type=giftcard&order_id="+this.order_id})},openDatetimePicker:function(t){this.$refs.myPicker.show()},closeDatetimePicker:function(){this.$refs.myPicker.hide()},handleSubmit:function(t){this.self_taking_time="".concat(t.year,"-").concat(t.month,"-").concat(t.day," ").concat(t.hour,":").concat(t.minute)},concat_input:function(t){this.default_concat=t.detail.value},myContactInfo:function(){var a=this;t.request({url:a.$host+"/api/MainWxapp/getMyContactInfo",data:{uniacid:a.$uniacid,suid:a.suid,add_id:a.add_id,shop_id:a.shop_id},success:function(t){a.default_address=t.data.data.default_address,a.default_address&&(a.add_id=a.default_address.id),t.data.data.default_concat&&(a.default_concat=t.data.data.default_concat.mobile),a.shop_info=t.data.data.shop_info,a.take_self=t.data.data.take_self,a.ps_name=t.data.data.ps_name,a.zq_name=t.data.data.zq_name}})},getpro:function(){var a=this,e=this,i=this.order_id;t.request({url:this.$host+"/api/mainwxapp/getpro",data:{uniacid:e.$uniacid,order_id:i},success:function(e){if(1==e.data.data.err)t.showModal({title:"提示",content:e.data.data.errmsg,showCancel:!1,success:function(a){a.confirm&&t.reLaunch({url:"/pagesGiftCard/my_giftcard/my_giftcard"})}});else{a.info=e.data.data.info;var i=a.nav,n=e.data.data.express_type;i?a.currentTab=2==i?2:1:1==n?(a.currentTab=2,a.nav=2):(a.currentTab=1,a.nav=2==n?3:1)}}})},sureGetPro:function(){var a=this;if(1==a.is_sub)return!1;var e=this.currentTab;if(2==e){var i=this.shop_id;if(!i)return t.showModal({title:"提示",content:"请先选择门店",showCancel:!1}),!1;var n=this.self_taking_time;if(!n)return t.showModal({title:"提示",content:"请先选择预约取件时间",showCancel:!1}),!1;var d=this.default_concat;if(!d)return t.showModal({title:"提示",content:"请先输入预留电话",showCancel:!1}),!1;var s=/^1[3456789]{1}\d{9}$/;if(!s.test(d))return t.showModal({title:"提醒",content:"请您输入正确的手机号码",showCancel:!1}),!1}else{var r=this.add_id;if(!r)return t.showModal({title:"提示",content:"请先选择收件地址",showCancel:!1}),!1}a.is_sub=1,t.request({url:this.$host+"/api/mainwxapp/useGiftcards",data:{uniacid:a.$uniacid,order_id:a.order_id,suid:t.getStorageSync("suid"),source:t.getStorageSync("source"),type:this.currentTab,add_id:this.add_id,shop_id:this.shop_id,self_taking_time:this.self_taking_time,self_taking_contact:this.default_concat},success:function(a){1==a.data.data.err?t.showModal({title:"提示",content:a.data.data.errmsg,showCancel:!1}):t.showToast({title:"使用成功",icon:"success",duration:2e3,success:function(a){t.redirectTo({url:"/pagesGiftCard/order_list/order_list"})}})}})}}};a.default=d}).call(this,e("5486")["default"])},"45c5":function(t,a,e){},7728:function(t,a,e){"use strict";var i=e("45c5"),n=e.n(i);n.a},bfda:function(t,a,e){"use strict";(function(t){e("d28f");i(e("66fd"));var a=i(e("ff28"));function i(t){return t&&t.__esModule?t:{default:t}}t(a.default)}).call(this,e("5486")["createPage"])},e0ac:function(t,a,e){"use strict";var i={datetime:()=>e.e("components/datetime/datetime").then(e.bind(null,"c598"))},n=function(){var t=this,a=t.$createElement;t._self._c},d=[];e.d(a,"b",function(){return n}),e.d(a,"c",function(){return d}),e.d(a,"a",function(){return i})},ff28:function(t,a,e){"use strict";e.r(a);var i=e("e0ac"),n=e("ff87");for(var d in n)"default"!==d&&function(t){e.d(a,t,function(){return n[t]})}(d);e("7728");var s,r=e("f0c5"),o=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);a["default"]=o.exports},ff87:function(t,a,e){"use strict";e.r(a);var i=e("0d9b"),n=e.n(i);for(var d in i)"default"!==d&&function(t){e.d(a,t,function(){return i[t]})}(d);a["default"]=n.a}},[["bfda","common/runtime","common/vendor"]]]);